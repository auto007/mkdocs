{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u9996\u9875","text":"<ul> <li>\u8bb0\u5f55\u5b66\u4e60\u8fc7\u7a0b\u7684\u70b9\u70b9\u6ef4\u6ef4</li> <li>\u7cfb\u7edf\u7684\u603b\u7ed3\u5f52\u7eb3\u9636\u6bb5\u6027\u7684\u5b66\u4e60\u6210\u679c</li> <li>\u5efa\u7acb\u77e5\u8bc6\u5e93\uff0c\u52a0\u6df1\u81ea\u5df1\u5bf9\u6280\u672f\u70b9\u7684\u7406\u89e3\uff0c\u5199\u7684\u8fc7\u7a0b\u4e5f\u662f\u4e00\u4e2a\u590d\u76d8\u7684\u8fc7\u7a0b</li> </ul>"},{"location":"k8s/%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E9%9C%80%E8%A6%81%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BAendpoint/","title":"\u4ec0\u4e48\u60c5\u51b5\u4e0b\u9700\u8981\u624b\u52a8\u521b\u5efaendpoint","text":"<pre><code>apiVersion: v1\nkind: Endpoints\nmetadata:\nlabels:\napp: etcd-prom\nname: etcd-prom\nnamespace: kube-system\nsubsets:\n- addresses:\n- ip: YOUR_ETCD_IP01\n- ip: YOUR_ETCD_IP02\n- ip: YOUR_ETCD_IP03\nports:\n- name: https-metrics\nport: 2379 # etcd \u7aef\u53e3\nprotocol: TCP\n---\napiVersion: v1\nkind: Service\nmetadata:\nlabels:\napp: etcd-prom\nname: etcd-prom\nnamespace: kube-system\nspec:\nports:\n- name: https-metrics\nport: 2379\nprotocol: TCP\ntargetPort: 2379\ntype: ClusterIP\n</code></pre> <p>\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u8981\u624b\u52a8\u521b\u5efaendpoint\u5462\uff0c\u4e0d\u662f\u521b\u5efasvc\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u521b\u5efaep\u5417?</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0cKubernetes Service \u521b\u5efa\u4ee5\u540e\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa\u5bf9\u5e94\u7684 Endpoints\uff08ep\uff09\uff0c\u4f46\u8fd9\u662f\u6709\u524d\u63d0\u6761\u4ef6\u7684\uff1a</p> <ol> <li> <p>Service \u7684 selector \u5339\u914d\u5230 Pod</p> <ul> <li> <p>\u6bd4\u5982\u4f60\u5199\u4e86\uff1a</p> <p><code>spec:   selector:     app: my-app</code></p> <p>\u90a3\u4e48 kube-controller-manager \u4f1a\u53bb\u627e\u5e26 <code>app=my-app</code> \u7684 Pod\uff0c\u628a\u5b83\u4eec\u7684 IP \u586b\u5230 Endpoint \u91cc\u3002</p> </li> </ul> </li> <li> <p>Pod \u5fc5\u987b\u7531 K8s \u7ba1\u7406</p> <ul> <li>\u5373 Pod \u5fc5\u987b\u5728\u96c6\u7fa4\u91cc\u8fd0\u884c\uff0c\u624d\u80fd\u88ab\u81ea\u52a8\u5173\u8054\u3002</li> </ul> </li> </ol> <p>\u4f46\u4f60\u8fd9\u91cc\u7684\u60c5\u51b5\u4e0d\u540c\uff1a</p> <ul> <li> <p>etcd \u662f \u96c6\u7fa4\u6838\u5fc3\u7ec4\u4ef6\uff0c\u4e00\u822c\u662f\u4f5c\u4e3a \u9759\u6001 Pod \u6216 \u72ec\u7acb\u8fdb\u7a0b \u5728 master \u8282\u70b9\u4e0a\u8fd0\u884c\u7684\uff0c\u800c\u4e0d\u662f\u50cf\u666e\u901a\u4e1a\u52a1 Pod \u4e00\u6837\u7531 Deployment/StatefulSet \u7ba1\u7406\u3002</p> </li> <li> <p>\u8fd9\u4e9b etcd Pod \u901a\u5e38\u4e0d\u4f1a\u5e26\u4e0a <code>label</code>\uff0c\u4e5f\u6ca1\u6709 selector \u80fd\u591f\u5339\u914d\u5230\u5b83\u4eec\u3002</p> </li> <li> <p>Service \u81ea\u7136\u65e0\u6cd5\u81ea\u52a8\u627e\u5230\u8fd9\u4e9b IP\uff0c\u81ea\u52a8\u751f\u6210\u7684 Endpoint \u5c31\u662f\u7a7a\u7684\u3002</p> </li> </ul> <p>\u6240\u4ee5\uff0c\u4f60\u9700\u8981 \u624b\u52a8\u5199 Endpoints\uff0c\u628a etcd \u5b9e\u9645\u7684 IP \u548c\u7aef\u53e3\u586b\u8fdb\u53bb\uff0c\u8fd9\u6837 Service \u624d\u80fd\u4ee3\u7406\u5230\u5b83\u4eec\u3002</p>"},{"location":"k8s/%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E9%9C%80%E8%A6%81%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BAendpoint/#_1","title":"\u603b\u7ed3","text":"<ul> <li> <p>\u666e\u901a\u5e94\u7528\uff1a\u521b\u5efa Service \u2192 \u81ea\u52a8\u751f\u6210 Endpoints\uff08\u56e0\u4e3a selector \u5339\u914d\u5230\u4e86 Pod\uff09\u3002</p> </li> <li> <p>\u6838\u5fc3\u7ec4\u4ef6\uff08\u5982 etcd\u3001apiserver\uff09\uff1a\u56e0\u4e3a\u6ca1\u6709 Pod/selector\uff0c\u5fc5\u987b\u624b\u52a8\u5199 Endpoints \u6765\u544a\u8bc9 Service \u540e\u7aef\u5730\u5740\u3002</p> </li> </ul> <p>\ud83d\udc49 \u4f60\u7684 <code>etcd-prom</code> Service + Endpoints\uff0c\u5c31\u662f\u4e3a\u4e86\u8ba9 Prometheus \u53ef\u4ee5\u901a\u8fc7 <code>etcd-prom.kube-system.svc:2379</code> \u7edf\u4e00\u8bbf\u95ee\u5230 etcd\uff0c\u800c\u4e0d\u7528\u76f4\u63a5\u5199\u6b7b\u8282\u70b9 IP\u3002</p>"},{"location":"k8s/%E6%97%A0%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%89%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"\u65e0\u72b6\u6001\u670d\u52a1\u548c\u6709\u72b6\u6001\u670d\u52a1\u7684\u533a\u522b","text":""},{"location":"k8s/%E6%97%A0%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%89%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%8C%BA%E5%88%AB/#1-stateless-service","title":"1. \u65e0\u72b6\u6001\u670d\u52a1\uff08Stateless Service\uff09","text":"<ul> <li> <p>\u5b9a\u4e49\uff1a\u670d\u52a1\u672c\u8eab\u4e0d\u4fdd\u5b58\u7528\u6237\u7684\u4f1a\u8bdd\u6570\u636e\u6216\u4e0a\u4e0b\u6587\u4fe1\u606f\uff0c\u6bcf\u6b21\u8bf7\u6c42\u90fd\u662f\u72ec\u7acb\u7684\u3002</p> </li> <li> <p>\u7279\u70b9\uff1a</p> <ul> <li> <p>\u8bf7\u6c42\u4e4b\u95f4\u6ca1\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u80fd\u5355\u72ec\u5904\u7406\u3002</p> </li> <li> <p>\u670d\u52a1\u4e0d\u9700\u8981\u8bb0\u4f4f\u7528\u6237\u7684\u5386\u53f2\u72b6\u6001\uff08\u767b\u5f55\u4fe1\u606f\u3001\u5904\u7406\u8fdb\u5ea6\u7b49\u9700\u8981\u4f9d\u8d56\u5916\u90e8\u5b58\u50a8\uff09\u3002</p> </li> <li> <p>\u6269\u5c55\u6027\u5f3a\uff1a\u53ef\u4ee5\u8f7b\u677e\u6c34\u5e73\u6269\u5c55\uff08\u52a0\u673a\u5668\u3001\u52a0\u526f\u672c\uff09\u3002</p> </li> <li> <p>\u5e38\u7528\u4e8e\u8d1f\u8f7d\u5747\u8861\u573a\u666f\uff0c\u8bf7\u6c42\u53ef\u4ee5\u968f\u610f\u843d\u5230\u4efb\u610f\u4e00\u4e2a\u526f\u672c\u3002</p> </li> </ul> </li> <li> <p>\u5178\u578b\u4f8b\u5b50\uff1a</p> <ul> <li> <p>Nginx\u3001\u9759\u6001\u7f51\u9875\u670d\u52a1</p> </li> <li> <p>RESTful API\uff08\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u5e26\u4e0a\u8ba4\u8bc1\u4fe1\u606f\uff09</p> </li> <li> <p>CDN \u670d\u52a1</p> </li> </ul> </li> </ul>"},{"location":"k8s/%E6%97%A0%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%89%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%8C%BA%E5%88%AB/#2-stateful-service","title":"2. \u6709\u72b6\u6001\u670d\u52a1\uff08Stateful Service\uff09","text":"<ul> <li> <p>\u5b9a\u4e49\uff1a\u670d\u52a1\u4f1a\u4fdd\u5b58\u548c\u4f9d\u8d56\u7528\u6237\u7684\u4f1a\u8bdd\u6570\u636e\u6216\u4e0a\u4e0b\u6587\u4fe1\u606f\uff0c\u8bf7\u6c42\u4e4b\u95f4\u6709\u4f9d\u8d56\u5173\u7cfb\u3002</p> </li> <li> <p>\u7279\u70b9\uff1a</p> <ul> <li> <p>\u8bf7\u6c42\u4e4b\u95f4\u76f8\u4e92\u5173\u8054\uff0c\u9700\u8981\u8bb0\u4f4f\u7528\u6237\u7684\u72b6\u6001\u3002</p> </li> <li> <p>\u8fc1\u79fb\u6216\u6269\u5bb9\u65f6\u9700\u8981\u8003\u8651\u72b6\u6001\u7684\u4e00\u81f4\u6027\u3001\u5b58\u50a8\u540c\u6b65\u3002</p> </li> <li> <p>\u901a\u5e38\u9700\u8981\u989d\u5916\u7684\u6570\u636e\u5b58\u50a8\u6765\u4fdd\u8bc1\u72b6\u6001\uff08\u6570\u636e\u5e93\u3001\u7f13\u5b58\u3001Session \u5b58\u50a8\uff09\u3002</p> </li> </ul> </li> <li> <p>\u5178\u578b\u4f8b\u5b50\uff1a</p> <ul> <li> <p>\u6570\u636e\u5e93\u670d\u52a1\uff08MySQL\u3001PostgreSQL\u3001Redis\uff09</p> </li> <li> <p>\u6d88\u606f\u961f\u5217\uff08Kafka\u3001RabbitMQ\uff09</p> </li> <li> <p>\u6e38\u620f\u670d\u52a1\u5668\uff08\u9700\u8981\u4fdd\u5b58\u73a9\u5bb6\u8fdb\u5ea6\uff09</p> </li> <li> <p>\u5e26 Session \u7684 Web \u5e94\u7528\uff08\u7528\u6237\u767b\u5f55\u72b6\u6001\u4fdd\u5b58\u5728\u672c\u5730\u5185\u5b58\u91cc\uff09</p> </li> </ul> </li> </ul>"},{"location":"k8s/%E6%97%A0%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%89%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%8C%BA%E5%88%AB/#3","title":"3. \u5bf9\u6bd4\u603b\u7ed3","text":"\u5bf9\u6bd4\u70b9 \u65e0\u72b6\u6001\u670d\u52a1 \u6709\u72b6\u6001\u670d\u52a1 \u8bf7\u6c42\u4f9d\u8d56 \u6bcf\u6b21\u8bf7\u6c42\u72ec\u7acb\uff0c\u65e0\u9700\u5386\u53f2\u6570\u636e \u8bf7\u6c42\u4f9d\u8d56\u5386\u53f2\u72b6\u6001\u6216\u4f1a\u8bdd \u6269\u5c55\u6027 \u6613\u4e8e\u6c34\u5e73\u6269\u5c55 \u6269\u5c55\u590d\u6742\uff0c\u9700\u8981\u4fdd\u6301\u72b6\u6001\u4e00\u81f4\u6027 \u5bb9\u9519\u6027 \u8282\u70b9\u6302\u4e86\uff0c\u6362\u53e6\u4e00\u4e2a\u8282\u70b9\u5373\u53ef \u8282\u70b9\u6302\u4e86\uff0c\u53ef\u80fd\u5bfc\u81f4\u72b6\u6001\u4e22\u5931 \u5178\u578b\u573a\u666f API \u7f51\u5173\u3001\u9759\u6001\u5185\u5bb9\u670d\u52a1 \u6570\u636e\u5e93\u3001\u6d88\u606f\u961f\u5217\u3001\u6e38\u620f\u670d\u52a1\u5668 <p>\ud83d\udc49 \u5728 Kubernetes \u91cc\u4e5f\u6709\u5bf9\u5e94\u6982\u5ff5\uff1a</p> <ul> <li> <p>\u65e0\u72b6\u6001\u5e94\u7528\uff1a<code>Deployment</code> \u7ba1\u7406\uff08Pod \u526f\u672c\u968f\u610f\u6269\u7f29\u5bb9\uff09\u3002</p> </li> <li> <p>\u6709\u72b6\u6001\u5e94\u7528\uff1a<code>StatefulSet</code> \u7ba1\u7406\uff08Pod \u6709\u56fa\u5b9a\u8eab\u4efd\u3001\u7a33\u5b9a\u7f51\u7edc\u548c\u6301\u4e45\u5b58\u50a8\uff09\u3002</p> </li> </ul>"}]}